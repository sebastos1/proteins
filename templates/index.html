<% include!("./header.html"); %>
  <body>
    <a href="/updater" class="updatebutton">update</a>
    <a href="/custom">custom product</a>
    <a href="/paper">custom list</a>
    <form action="/search">
        <input type="text" name="search" value="" placeholder="Showing <%= &y.len() %> foods">
        <input type="hidden" name="id" value="<%= rng %>">
        <input type="submit" style="visibility:hidden;height:0%">
    </form>
    <% if sortword != "" { %>
        <h3>Sorting by: <%= sortword%></h3>
    <% } else { %>
        <h3>Not sorting</h3>
    <% } %>
    <table class="mainlist">
        <tr>
            <td>Name</td>
            <% for item in &x { %>
                <td>
                    <form action="/sort" >
                        <input type="hidden" name="sortby" value="<%= item %>">
                        <input type="hidden" name="id" value="<%= rng %>">
                        <input type="submit" value="<%= item %>" class="sortbutton">
                    </form>
                </td>
            <% } %>
        </tr>

        <% let end: usize; %>
        <% let ind = ind; %>

        <% if y.len() < entries { %>
            <% end = y.len(); %>
        <% } else if ind >= y.len()-entries { %>
            <% end = y.len(); %>
        <% } else { %>
            <% end = ind + entries; %>
        <% } %>

        <% for k in &y[ind..end] { %>
                <td><a href="/product/<%= k %>"><%= k %></a></td>
                <% for entry in &x { %>
                    <% if foods[k].contains_key(&entry.to_string()) { %>
                        <td><%= foods[k][&entry.to_string()] %></td>
                    <% } else { %>
                        <td><%= "0" %></td>
                    <% } %>
                <% } %>
            </tr>
        <% } %>
    </table>
    <% if ind >= entries { %>
        <form action="/change" >
            <input type="hidden" name="goto" value="down">
            <input type="hidden" name="id" value="<%= rng %>">
            <input type="submit" value="Prev page" class="sortbutton">
        </form>
    <% } %>
    <% if y.len() > entries && ind < y.len()-entries { %>
        <form action="/change" >
            <input type="hidden" name="goto" value="up">
            <input type="hidden" name="id" value="<%= rng %>">
            <input type="submit" value="Next page" class="sortbutton">
        </form>
    <% } %>
    
  </body>
</html>
